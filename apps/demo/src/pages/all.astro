---
/**
 * All Components - Single page view of every component
 * For reviewing the complete design system at a glance
 */

import { ComponentDemo, hasDemoFor } from '../components/demos/ComponentDemo';
import GalleryLayout from '../layouts/GalleryLayout.astro';
import { getComponentNames, loadComponent } from '../lib/component-registry';

const allComponents = getComponentNames()
  .map((name) => ({ name, component: loadComponent(name) }))
  .filter(({ component }) => component !== null);
---

<GalleryLayout title="All Components" description="Complete component overview">
  <div class="flex flex-col gap-12">
    <header class="pb-6 border-b border-border">
      <h1 class="font-mono text-3xl font-medium tracking-wider text-foreground m-0">
        All Components
      </h1>
      <p class="text-base text-muted-foreground mt-2">
        {allComponents.length} components in the Rafters design system
      </p>
    </header>

    {allComponents.map(({ name, component }) => (
      <section class="pb-8 border-b border-border/50">
        <div class="flex items-baseline gap-4 mb-4">
          <h2 class="font-mono text-xl font-medium tracking-wider text-foreground m-0">
            {component.displayName}
          </h2>
          <span class="font-mono text-xs text-muted-foreground">
            {component.category}
          </span>
          <a
            href={`/components/${name}`}
            class="font-mono text-xs text-primary no-underline hover:underline ml-auto"
          >
            View Details
          </a>
        </div>

        <p class="text-sm text-muted-foreground mb-4 max-w-prose">
          {component.description || component.intelligence.cognitiveLoad.description}
        </p>

        <div class="bg-card border border-border p-6">
          {hasDemoFor(name) ? (
            <ComponentDemo name={name} client:load />
          ) : (
            <p class="text-sm text-muted-foreground/50 italic text-center py-4">
              Demo coming soon
            </p>
          )}
        </div>
      </section>
    ))}
  </div>
</GalleryLayout>
