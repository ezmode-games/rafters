---
/**
 * GridOverlay - SVG-based blueprint grid background
 * Creates the technical drawing aesthetic
 */

interface Props {
  density?: 'coarse' | 'fine' | 'ultra';
  showAxes?: boolean;
  class?: string;
}

const { density = 'fine', showAxes = false, class: className = '' } = Astro.props;

const gridSizes = {
  coarse: { major: 80, minor: 20 },
  fine: { major: 40, minor: 8 },
  ultra: { major: 20, minor: 4 },
};

const { major, minor } = gridSizes[density];
const patternId = `grid-${density}-${Math.random().toString(36).slice(2, 8)}`;
---

<div class={`absolute inset-0 pointer-events-none z-0 overflow-hidden ${className}`} data-density={density}>
  <svg
    class="w-full h-full"
    width="100%"
    height="100%"
    xmlns="http://www.w3.org/2000/svg"
    aria-hidden="true"
  >
    <defs>
      <!-- Minor grid pattern -->
      <pattern
        id={`${patternId}-minor`}
        width={minor}
        height={minor}
        patternUnits="userSpaceOnUse"
      >
        <path
          d={`M ${minor} 0 L 0 0 0 ${minor}`}
          fill="none"
          class="stroke-border/30"
          stroke-width="0.5"
        />
      </pattern>

      <!-- Major grid pattern -->
      <pattern
        id={`${patternId}-major`}
        width={major}
        height={major}
        patternUnits="userSpaceOnUse"
      >
        <rect width={major} height={major} fill={`url(#${patternId}-minor)`} />
        <path
          d={`M ${major} 0 L 0 0 0 ${major}`}
          fill="none"
          class="stroke-border"
          stroke-width="1"
        />
      </pattern>
    </defs>

    <rect width="100%" height="100%" fill={`url(#${patternId}-major)`} />

    {showAxes && (
      <g class="axes">
        <line
          x1="50%"
          y1="0"
          x2="50%"
          y2="100%"
          class="stroke-primary"
          stroke-width="1"
          stroke-dasharray="4 2"
        />
        <line
          x1="0"
          y1="50%"
          x2="100%"
          y2="50%"
          class="stroke-primary"
          stroke-width="1"
          stroke-dasharray="4 2"
        />
      </g>
    )}
  </svg>
</div>
