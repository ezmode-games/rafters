---
/**
 * IntelligencePanel - Full intelligence metadata display
 * Shows all 5 dimensions plus usage patterns
 */

import type { ParsedIntelligence } from '../../lib/types';
import SectionDivider from '../blueprint/SectionDivider.astro';
import CognitiveLoadMeter from './CognitiveLoadMeter.astro';
import IntelligenceDimension from './IntelligenceDimension.astro';
import UsagePatterns from './UsagePatterns.astro';

interface Props {
  intelligence: ParsedIntelligence;
  class?: string;
}

const { intelligence, class: className = '' } = Astro.props;
---

<aside class={`p-6 bg-muted/30 border border-border ${className}`}>
  <header class="flex items-center justify-between mb-6">
    <h2 class="font-mono text-xs font-medium tracking-widest uppercase text-foreground m-0">
      Component Intelligence
    </h2>
    <span class="font-mono text-xs tracking-widest uppercase px-2 py-0.5 bg-primary/10 border border-border text-primary">
      JSDoc Metadata
    </span>
  </header>

  <!-- Cognitive Load - Special visual treatment -->
  <section class="mb-4">
    <h3 class="font-mono text-xs font-medium tracking-widest uppercase text-muted-foreground m-0 mb-4">
      Cognitive Load
    </h3>
    <CognitiveLoadMeter score={intelligence.cognitiveLoad.score} />
    <p class="text-sm leading-relaxed text-muted-foreground mt-3 m-0">
      {intelligence.cognitiveLoad.description}
    </p>
  </section>

  <SectionDivider />

  <!-- Other dimensions in grid -->
  <section>
    <h3 class="font-mono text-xs font-medium tracking-widest uppercase text-muted-foreground m-0 mb-4">
      Intelligence Dimensions
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {intelligence.attentionEconomics && (
        <IntelligenceDimension
          title="Attention Economics"
          icon="eye"
          content={intelligence.attentionEconomics}
        />
      )}
      {intelligence.trustBuilding && (
        <IntelligenceDimension
          title="Trust Building"
          icon="shield"
          content={intelligence.trustBuilding}
        />
      )}
      {intelligence.accessibility && (
        <IntelligenceDimension
          title="Accessibility"
          icon="accessibility"
          content={intelligence.accessibility}
        />
      )}
      {intelligence.semanticMeaning && (
        <IntelligenceDimension
          title="Semantic Meaning"
          icon="tag"
          content={intelligence.semanticMeaning}
        />
      )}
    </div>
  </section>

  <!-- Usage Patterns -->
  {(intelligence.usagePatterns.dos.length > 0 || intelligence.usagePatterns.nevers.length > 0) && (
    <>
      <SectionDivider />
      <section class="mt-4">
        <h3 class="font-mono text-xs font-medium tracking-widest uppercase text-muted-foreground m-0 mb-4">
          Usage Patterns
        </h3>
        <UsagePatterns
          dos={intelligence.usagePatterns.dos}
          nevers={intelligence.usagePatterns.nevers}
        />
      </section>
    </>
  )}
</aside>
