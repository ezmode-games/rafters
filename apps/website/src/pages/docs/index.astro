---
import { getCollection } from 'astro:content';
import DocsLayout from '../../layouts/DocsLayout.astro';

// Get foundation and component docs for overview
const foundationDocs = await getCollection('foundation', ({ data }) => !data.draft);
const componentDocs = await getCollection('components', ({ data }) => !data.draft);

foundationDocs.sort((a, b) => (a.data.order || 999) - (b.data.order || 999));
componentDocs.sort((a, b) => (a.data.order || 999) - (b.data.order || 999));
---

<DocsLayout title="Documentation" description="Comprehensive guide to Rafters design system with embedded intelligence">
  <div class="space-y-12">
    <div>
      <h1 class="text-4xl font-mono font-semibold mb-8">Documentation</h1>
      <p class="text-xl text-gray-600 mb-8">
        Complete guide to building with Rafters - the AI-first design system with embedded human reasoning.
      </p>
    </div>

    <!-- Foundation Documentation -->
    <section>
      <h2 class="text-2xl font-semibold mb-6">Foundation</h2>
      <p class="text-base text-gray-600 mb-6">
        Learn the core principles, systems, and frameworks that power Rafters design intelligence.
      </p>
      <div class="grid md:grid-cols-2 gap-6">
        {foundationDocs.map((doc) => (
          <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
            <h3 class="text-lg font-semibold mb-3">
              <a href={`/docs/foundation/${doc.slug}`} class="hover:text-primary-700">
                {doc.data.title}
              </a>
            </h3>
            <p class="text-sm text-gray-600 mb-4">{doc.data.description}</p>
            <a 
              href={`/docs/foundation/${doc.slug}`}
              class="text-sm text-primary-600 hover:text-primary-700 font-medium"
            >
              Read more →
            </a>
          </div>
        ))}
      </div>
    </section>

    <!-- Component Documentation -->
    <section>
      <h2 class="text-2xl font-semibold mb-6">Components</h2>
      <p class="text-base text-gray-600 mb-6">
        Browse individual components with embedded design intelligence, cognitive load ratings, and usage patterns.
      </p>
      <div class="grid md:grid-cols-2 gap-6">
        {componentDocs.map((doc) => (
          <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
            <div class="flex justify-between items-start mb-3">
              <h3 class="text-lg font-semibold">
                <a href={`/docs/components/${doc.slug}`} class="hover:text-primary-700">
                  {doc.data.title}
                </a>
              </h3>
              {doc.data.cognitiveLoad !== undefined && (
                <span class="text-xs bg-blue-100 px-2 py-1 rounded">
                  {doc.data.cognitiveLoad}/10
                </span>
              )}
            </div>
            <p class="text-sm text-gray-600 mb-4">{doc.data.description}</p>
            {doc.data.attentionEconomics && (
              <p class="text-xs text-gray-500 mb-4 italic">
                {doc.data.attentionEconomics}
              </p>
            )}
            <a 
              href={`/docs/components/${doc.slug}`}
              class="text-sm text-primary-600 hover:text-primary-700 font-medium"
            >
              View component →
            </a>
          </div>
        ))}
      </div>
    </section>

    <!-- Quick Links -->
    <section>
      <h2 class="text-2xl font-semibold mb-6">Quick Links</h2>
      <div class="grid md:grid-cols-3 gap-6">
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
          <h3 class="text-lg font-semibold mb-3">Component Registry</h3>
          <p class="text-sm text-gray-600 mb-4">
            Browse the complete component catalog with JSON API access for AI agents.
          </p>
          <a 
            href="/registry"
            class="text-sm text-primary-600 hover:text-primary-700 font-medium"
          >
            View Registry →
          </a>
        </div>
        
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
          <h3 class="text-lg font-semibold mb-3">AI Documentation</h3>
          <p class="text-sm text-gray-600 mb-4">
            Machine-readable documentation specifically formatted for AI agent consumption.
          </p>
          <a 
            href="/llms.txt"
            class="text-sm text-primary-600 hover:text-primary-700 font-medium"
          >
            View LLMs.txt →
          </a>
        </div>

        <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
          <h3 class="text-lg font-semibold mb-3">GitHub Repository</h3>
          <p class="text-sm text-gray-600 mb-4">
            Source code, issues, and contributions for the Rafters design system.
          </p>
          <a 
            href="https://github.com/real-handy/rafters"
            class="text-sm text-primary-600 hover:text-primary-700 font-medium"
            target="_blank"
            rel="noopener"
          >
            View on GitHub →
          </a>
        </div>
      </div>
    </section>
  </div>
</DocsLayout>