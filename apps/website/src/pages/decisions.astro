---
import { getCollection } from 'astro:content';
import MarketingLayout from '../layouts/MarketingLayout.astro';

const title = 'Build Decisions – Rafters';
const description = 'Real-time documentation of architectural decisions and design evolution';
const headerTitle = 'Build Decisions';

const decisions = await getCollection('decisions');
const sortedDecisions = decisions.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime(),
);
---

<MarketingLayout 
  title={title} 
  description={description} 
  headerTitle={headerTitle}
  headerTitleClasses="text-4xl leading-3 tracking-wide"
>
  <div class="prose prose-lg max-w-none">
    <p class="text-xl text-gray-600 mb-8">
      <em>Real-time documentation of major decisions, trade-offs, and architectural evolution in the Rafters design system.</em>
    </p>

    <hr class="my-8 border-gray-200" />

    <p class="text-lg leading-relaxed mb-8">
      This is where we document the big choices, the "why" behind major changes, and the evolution of Rafters as we build it. Think of it as a combination of:
    </p>

    <ul class="space-y-2 mb-12">
      <li><strong>Architectural Decision Records (ADRs)</strong> - The formal decisions that shape the system</li>
      <li><strong>Build Blog</strong> - The story of how and why we're building what we're building</li>
      <li><strong>Decision Journal</strong> - Capturing trade-offs, alternatives considered, and outcomes</li>
    </ul>

    <h2 class="text-2xl font-bold mb-6">Current Decisions</h2>

    {sortedDecisions.map((decision) => (
      <div class="bg-white border border-gray-200 rounded-lg p-6 mb-8 hover:shadow-md transition-shadow">
        <h3 class="text-xl font-semibold mb-3">
          <a href={`/decisions/${decision.slug}`} class="text-blue-600 hover:text-blue-800 no-underline">
            {decision.data.title}
          </a>
        </h3>
        <div class="text-sm text-gray-500 mb-3">
          <span class={`inline-block px-2 py-1 rounded text-xs font-medium mr-2 ${
            decision.data.status === 'completed' ? 'bg-green-100 text-green-800' :
            decision.data.status === 'in-progress' ? 'bg-yellow-100 text-yellow-800' :
            decision.data.status === 'draft' ? 'bg-gray-100 text-gray-800' :
            decision.data.status === 'deprecated' ? 'bg-red-100 text-red-800' :
            decision.data.status === 'superseded' ? 'bg-purple-100 text-purple-800' :
            'bg-gray-100 text-gray-800'
          }`}>
            {decision.data.status}
          </span>
          <span class={`inline-block px-2 py-1 rounded text-xs font-medium mr-2 ${
            decision.data.impact === 'critical' ? 'bg-red-100 text-red-800' :
            decision.data.impact === 'major' ? 'bg-orange-100 text-orange-800' :
            'bg-blue-100 text-blue-800'
          }`}>
            {decision.data.impact} impact
          </span>
          <span>
            {new Date(decision.data.date).toLocaleDateString()} • {decision.data.category}
          </span>
        </div>
        <p class="text-gray-700 mb-0">
          {decision.body.slice(0, 200)}...
        </p>
      </div>
    ))}

    <hr class="my-12 border-gray-200" />

    <h2 class="text-2xl font-bold mb-6">Decision Categories</h2>

    <div class="grid md:grid-cols-2 gap-4 mb-12">
      <div class="space-y-3">
        <strong class="text-gray-900">Architecture</strong> - Fundamental system design choices
      </div>
      <div class="space-y-3">
        <strong class="text-gray-900">Developer Experience</strong> - Tools, workflows, and development patterns
      </div>
      <div class="space-y-3">
        <strong class="text-gray-900">AI Integration</strong> - Decisions around AI-first design and agent compatibility
      </div>
      <div class="space-y-3">
        <strong class="text-gray-900">Performance</strong> - Trade-offs around speed, bundle size, and runtime characteristics
      </div>
      <div class="space-y-3">
        <strong class="text-gray-900">Accessibility</strong> - Inclusive design decisions and WCAG compliance approaches
      </div>
    </div>

    <h2 class="text-2xl font-bold mb-6">Why Document Decisions?</h2>

    <div class="grid md:grid-cols-3 gap-6 mb-12">
      <div>
        <h3 class="text-lg font-semibold mb-3">For the Team</h3>
        <ul class="space-y-1 text-sm text-gray-700">
          <li><strong>Context Preservation</strong> - Future developers understand why choices were made</li>
          <li><strong>Trade-off Transparency</strong> - Document what we gave up to get what we wanted</li>
          <li><strong>Decision Velocity</strong> - Avoid re-litigating solved problems</li>
        </ul>
      </div>
      
      <div>
        <h3 class="text-lg font-semibold mb-3">For the Community</h3>
        <ul class="space-y-1 text-sm text-gray-700">
          <li><strong>Learning Resource</strong> - See how design systems evolve in practice</li>
          <li><strong>Contribution Context</strong> - Understand the reasoning behind current architecture</li>
          <li><strong>Inspiration</strong> - Real-world examples of design system decision-making</li>
        </ul>
      </div>
      
      <div>
        <h3 class="text-lg font-semibold mb-3">For AI Agents</h3>
        <ul class="space-y-1 text-sm text-gray-700">
          <li><strong>Historical Context</strong> - AI can understand the evolution and reasoning</li>
          <li><strong>Decision Patterns</strong> - Learn from our decision-making process</li>
          <li><strong>Implementation Guidance</strong> - Understand why we chose certain approaches</li>
        </ul>
      </div>
    </div>

    <hr class="my-8 border-gray-200" />

    <p class="text-gray-600 italic text-center">
      Each decision captures the problem, alternatives considered, choice made, and outcomes. This creates a living history of the project's evolution.
    </p>
  </div>
</MarketingLayout>