import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="00 Introduction/Migration Guide" />

# Migration Guide: 7-File Component Pattern

How to upgrade existing components to follow the comprehensive Button and Dialog pattern.

## Migration Overview

Based on our successful implementation of Button and Dialog, all remaining components need to be upgraded to the 7-file pattern for consistency and depth.

### Current Status Assessment

#### ‚úÖ Fully Implemented (Template Components)
- **Button** - Complete 7-file pattern with trust-building intelligence
- **Dialog** - Comprehensive trust levels and progressive confirmation

#### üîÑ Requires Migration
- **Input** - Has Intelligence story, needs 6 additional files
- **Select** - Has Accessibility, Intelligence, Properties, Semantic, Variants - needs MDX overview
- **Tabs** - Has MDX, main story, Accessibility, Intelligence, Properties, Variants - needs Semantic
- **Card** - Has Intelligence only, needs 6 additional files  
- **Label** - Has Intelligence only, needs 6 additional files
- **Slider** - Has Intelligence only, needs 6 additional files

## Migration Strategy

### Phase 1: Complete Near-Complete Components
Priority order based on existing file count:

1. **Select** (5/7 files) - Add MDX overview + Semantic stories
2. **Tabs** (6/7 files) - Add Semantic stories  
3. **Input** (1/7 files) - Add 6 missing files
4. **Card** (1/7 files) - Add 6 missing files
5. **Label** (1/7 files) - Add 6 missing files  
6. **Slider** (1/7 files) - Add 6 missing files

### Phase 2: Implement Remaining 28 Components
Follow established 7-file pattern for all GitHub issues.

## Component-Specific Migration Plans

### Select Component Migration

**Current State**: Has 5/7 files
- ‚úÖ SelectAccessibility.stories.tsx
- ‚úÖ SelectIntelligence.stories.tsx  
- ‚úÖ SelectProperties.stories.tsx
- ‚úÖ SelectSemantic.stories.tsx
- ‚úÖ SelectVariants.stories.tsx
- ‚ùå Select.mdx (needs creation)
- ‚ùå Select.stories.tsx (needs main Common story)

**Migration Steps**:
1. Create Select.mdx overview following Dialog template
2. Update/create Select.stories.tsx with comprehensive Common story
3. Review existing files for consistency with Button/Dialog patterns

**Expected Timeline**: 1-2 hours

### Tabs Component Migration

**Current State**: Has 6/7 files  
- ‚úÖ Tabs.mdx
- ‚úÖ Tabs.stories.tsx
- ‚úÖ TabsAccessibility.stories.tsx
- ‚úÖ TabsIntelligence.stories.tsx
- ‚úÖ TabsProperties.stories.tsx
- ‚úÖ TabsVariants.stories.tsx
- ‚ùå TabsSemantic.stories.tsx (needs creation)

**Migration Steps**:
1. Create TabsSemantic.stories.tsx following Dialog template
2. Review existing files for trust-level implementation
3. Ensure MDX follows current documentation standards

**Expected Timeline**: 30-60 minutes

### Input Component Migration

**Current State**: Has 1/7 files
- ‚úÖ InputIntelligence.stories.tsx
- ‚ùå Input.mdx (needs creation)
- ‚ùå Input.stories.tsx (needs creation)
- ‚ùå InputAccessibility.stories.tsx (needs creation)
- ‚ùå InputProperties.stories.tsx (needs creation)
- ‚ùå InputSemantic.stories.tsx (needs creation)
- ‚ùå InputVariants.stories.tsx (needs creation)

**Migration Steps**:
1. Analyze existing Input component for trust-building opportunities
2. Create complete 7-file pattern using Button/Dialog as templates
3. Implement input-specific trust patterns (validation, error states)
4. Add cognitive complexity considerations for form inputs

**Expected Timeline**: 3-4 hours

## Migration Templates

### MDX Overview Template
Use this structure for new .mdx files:

```mdx
import { Meta, Canvas } from '@storybook/addon-docs/blocks';
import * as Stories from './ComponentName.stories.tsx';

<Meta title="03 Components/Category/ComponentName" of={Stories} name="Overview" />

# ComponentName
[Component purpose and trust-building philosophy]

<Canvas of={Stories.Common} />

## Usage Guidelines
[Clear usage patterns with trust considerations]

#### DOs
- **Component Purpose**
  - [Trust-appropriate usage]
  - [Consequence-aware applications]
- **Trust Building**
  - [How this component builds confidence]
  - [Anxiety reduction patterns]

#### DON'Ts
- **Component Misuse**
  - [Anti-patterns that break trust]
  - [Inappropriate usage contexts]
- **Trust Violations**
  - [Patterns that create user anxiety]
  - [Poor consequence communication]

#### Use Cases
- **[Trust Level]**: [Specific use cases]
- **[Trust Level]**: [Specific use cases]

#### Trust Levels
- **Low**: [Low-stakes usage patterns]
- **Medium**: [Moderate-stakes usage patterns] 
- **High**: [High-stakes usage patterns]
- **Critical**: [Critical-stakes usage patterns]
```

### Common Story Template
Use this structure for main .stories.tsx files:

```tsx
import type { Meta, StoryObj } from '@storybook/react-vite';
import { fn } from 'storybook/test';
import { ComponentName } from '../../../components/ComponentName';

/**
 * [Trust-building philosophy statement for this component]
 */
const meta = {
  title: '03 Components/Category/ComponentName',
  component: ComponentName,
  tags: ['!autodocs', '!dev', 'test'],
  parameters: {
    layout: 'centered',
    docs: {
      description: {
        component: '[Component description with trust focus]',
      },
    },
  },
  argTypes: {
    trustLevel: {
      control: 'select',
      options: ['low', 'medium', 'high', 'critical'],
      description: 'Trust level affects visual hierarchy and behavior',
    },
    // [Additional component-specific argTypes]
  },
} satisfies Meta<typeof ComponentName>;

export default meta;
type Story = StoryObj<typeof meta>;

/**
 * Common component demonstrations showing all trust levels and key variants.
 */
export const Common: Story = {
  render: (args) => (
    <div className="space-y-4">
      <div className="text-sm text-muted-foreground mb-6">
        <strong>[Component] Trust Levels:</strong> [Description of progression]
      </div>
      
      <div className="flex gap-4 flex-wrap">
        {/* Show all trust levels and major variants */}
        <ComponentName {...args} trustLevel="low" />
        <ComponentName {...args} trustLevel="medium" />
        <ComponentName {...args} trustLevel="high" />
        <ComponentName {...args} trustLevel="critical" />
      </div>
    </div>
  ),
  parameters: {
    docs: {
      description: {
        story: '[Description of what this story demonstrates]',
      },
    },
  },
};
```

## Trust Implementation Checklist

For each component being migrated, ensure:

### ‚úÖ Trust Levels
- [ ] Four trust levels implemented (low, medium, high, critical)
- [ ] Visual hierarchy matches consequence severity
- [ ] Appropriate friction for each level
- [ ] Clear escape routes and undo patterns

### ‚úÖ Accessibility Intelligence  
- [ ] WCAG AAA compliance (7:1 contrast ratios)
- [ ] Keyboard navigation fully implemented
- [ ] Screen reader optimization with ARIA
- [ ] Focus management and trapping where appropriate

### ‚úÖ Behavioral Intelligence
- [ ] Smart defaults based on context
- [ ] Progressive confirmation for destructive actions
- [ ] Loading states with clear communication
- [ ] Error recovery with helpful guidance

### ‚úÖ Documentation Depth
- [ ] Complete 7-file story pattern
- [ ] Real-world usage examples
- [ ] Trust-building explanations
- [ ] Interactive controls for all props

## Quality Assurance

### Testing Requirements
Each migrated component must pass:

1. **Visual Regression Testing** - All variants render correctly
2. **Accessibility Testing** - Full keyboard navigation and screen reader support
3. **Interactive Testing** - All argTypes controls work properly  
4. **Trust Pattern Testing** - Appropriate friction and confirmation flows
5. **Documentation Testing** - All examples are functional and clear

### Review Criteria
Before marking migration complete:

- [ ] Follows exact 7-file pattern structure
- [ ] Implements trust-building intelligence appropriately
- [ ] Maintains consistency with Button and Dialog patterns
- [ ] Provides comprehensive real-world examples
- [ ] Demonstrates all component capabilities
- [ ] Includes proper accessibility implementation

## Implementation Priority

### Immediate (Next Sprint)
1. **Select** - Nearly complete, quick win
2. **Tabs** - Nearly complete, quick win

### Near-term (Following Sprint)  
3. **Input** - Foundation for form components
4. **Card** - Common layout component

### Medium-term
5. **Label** - Pairs with Input
6. **Slider** - Specialized interaction component

### Long-term
7-33. Remaining 27 components from GitHub issues

## Success Metrics

### Completion Criteria
- All existing components follow 7-file pattern
- Consistent trust-building implementation across library  
- Comprehensive documentation depth matching Button/Dialog
- Full accessibility compliance across all components

### Quality Indicators
- Storybook navigation is predictable and consistent
- Every component demonstrates trust-building intelligence
- Documentation provides clear implementation guidance
- Real-world examples inspire confident usage

---

**Goal**: Transform Rafters into a truly comprehensive, trust-building component library where every component demonstrates the same depth and intelligence as our Button and Dialog implementations.